{%- comment -%}
  GOLD PRODUCTS SHOWCASE — App Block (Premium)
  Handle (filename): gold-products-premium
  Version: collection-based (compliant — no multiple product pickers)
{%- endcomment -%}

{%- assign ns = 'gps-' | append: block.id -%}
{%- assign cols = block.settings.columns | default: 3 -%}
{%- assign img_size = block.settings.image_size | default: 480 -%}
{%- assign count = block.settings.max_products | default: 8 -%}
{%- assign coll = block.settings.collection -%}

<div class="{{ ns }}-wrap">
  {%- if block.settings.heading != blank or block.settings.subheading != blank -%}
    <div class="{{ ns }}-head">
      {%- if block.settings.heading != blank -%}
        <h2 class="{{ ns }}-title">{{ block.settings.heading }}</h2>
      {%- endif -%}
      {%- if block.settings.subheading != blank -%}
        <p class="{{ ns }}-subtitle">{{ block.settings.subheading }}</p>
      {%- endif -%}
    </div>
  {%- endif -%}

  {%- if coll == blank -%}
    <div class="{{ ns }}-empty">
      Sélectionnez une <strong>collection</strong> dans les réglages du bloc.
    </div>
  {%- else -%}
    <div class="{{ ns }}-grid {{ ns }}-cols-{{ cols }}">
      {%- for p in coll.products limit: count -%}
        <article class="{{ ns }}-card">
          <a class="{{ ns }}-link" href="{{ p.url | escape }}">
            <div class="{{ ns }}-media">
              {%- if p.featured_image -%}
                <img
                  src="{{ p.featured_image | image_url: width: img_size }}"
                  width="{{ img_size }}" height="{{ img_size }}"
                  alt="{{ p.title | escape }}" loading="lazy" decoding="async" />
              {%- endif -%}
              <span class="{{ ns }}-shine" aria-hidden="true"></span>
            </div>
            <div class="{{ ns }}-info">
              <h3 class="{{ ns }}-name">{{ p.title }}</h3>
              <div class="{{ ns }}-price">
                <span class="{{ ns }}-amount">
                  {%- if p.price -%}{{ p.price | money_with_currency }}{%- endif -%}
                </span>
                {%- if p.compare_at_price and p.compare_at_price > p.price -%}
                  <s class="{{ ns }}-compare">{{ p.compare_at_price | money_with_currency }}</s>
                {%- endif -%}
              </div>
            </div>
          </a>
        </article>
      {%- endfor -%}
    </div>
  {%- endif -%}
</div>

<style>
  .{{ ns }}-wrap{
    --gold-1: #8A6A2A;
    --gold-2: #F7DFA5;
    --gold-3: #C9A34A;
    --ink: #111;
    --muted: #6b7280;
  }

  .{{ ns }}-head{ text-align:center; margin-bottom: 18px; }
  .{{ ns }}-title{
    font: 700 22px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    background: linear-gradient(135deg, var(--gold-3), var(--gold-2));
    -webkit-background-clip: text; background-clip: text; color: transparent;
    display:inline-block;
  }
  .{{ ns }}-subtitle{
    margin-top: 6px;
    color: var(--muted);
    font: 500 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  }

  .{{ ns }}-grid{
    display:grid; gap: 14px;
    grid-template-columns: repeat({{ cols }}, minmax(0,1fr));
  }
  @media (max-width: 989px){
    .{{ ns }}-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  }
  @media (max-width: 520px){
    .{{ ns }}-grid{ grid-template-columns: repeat(1, minmax(0,1fr)); }
  }

  .{{ ns }}-card{
    position:relative; overflow:hidden; border-radius: 16px;
    background:
      radial-gradient(120% 120% at -10% -10%, rgba(255,255,255,0.9), transparent 40%),
      linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6)),
      linear-gradient(135deg, var(--gold-1), var(--gold-3));
    box-shadow: 0 10px 24px rgba(0,0,0,.12);
    transition: transform .2s ease, box-shadow .2s ease;
  }
  .{{ ns }}-card:hover{ transform: translateY(-3px); box-shadow: 0 16px 28px rgba(0,0,0,.16); }

  .{{ ns }}-link{ display:block; color:inherit; text-decoration:none; }

  .{{ ns }}-media{
    position:relative; aspect-ratio: 1 / 1; overflow:hidden;
    border-bottom: 1px solid rgba(0,0,0,.06);
  }
  .{{ ns }}-media img{
    width:100%; height:100%; object-fit:cover; display:block;
  }
  .{{ ns }}-shine{
    position:absolute; inset:0; pointer-events:none; mix-blend-mode:soft-light;
    background: radial-gradient(120% 60% at 0% 0%, rgba(255,255,255,.6), rgba(255,255,255,0)),
                linear-gradient(135deg, rgba(255,255,255,.18), rgba(255,255,255,0));
  }

  .{{ ns }}-info{ padding: 12px 14px 14px; }
  .{{ ns }}-name{
    font: 700 15px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    color: #1f2937; margin: 0 0 6px 0;
  }
  .{{ ns }}-price{
    display:flex; align-items:center; gap:8px;
    font: 700 14px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
    color: #111;
  }
  .{{ ns }}-compare{ color:#6b7280; font-weight:600; }
</style>

{% schema %}
{
  "name": "Gold Products Showcase",
  "target": "section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Titre", "default": "Sélection Or" },
    { "type": "text", "id": "subheading", "label": "Sous-titre", "default": "Nos best-sellers, version gold ✨" },

    { "type": "range", "id": "columns", "label": "Colonnes (desktop)", "min": 2, "max": 4, "step": 1, "default": 3 },
    { "type": "range", "id": "image_size", "label": "Taille image (px)", "min": 320, "max": 960, "step": 40, "default": 480 },

    { "type": "collection", "id": "collection", "label": "Collection source" },
    { "type": "range", "id": "max_products", "label": "Nombre maxi de produits", "min": 1, "max": 12, "step": 1, "default": 8 }
  ]
}
{% endschema %}
